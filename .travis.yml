matrix:
  include:
    - os: osx
      language: generic
      env:
        - PYENV_PYTHON="2.7.14"

    - os: osx
      language: generic
      env:
        - PYENV_PYTHON="3.6.1"

    - os: linux
      language: generic
      env:
        - PYENV_PYTHON="2.7.14"

    - os: linux
      language: generic
      env:
        - PYENV_PYTHON="3.6.1"

install:
  - |
    if [[ $TRAVIS_OS_NAME == 'osx' ]]; then
        brew update
        brew install pyenv
        brew upgrade pyenv
    fi
  - pyenv install --list
  - python --version
  - pyenv local "$PYENV_PYTHON"
  - python --version
  - ./configure


script:
  - bin/about-code check --verbose .
  - "bin/py.test -vvs"


notifications:
  irc:
    channels:
      - "chat.freenode.net#aboutcode"
  on_success: change
  on_failure: always
  use_notice: true
  skip_join: true
  template:
    - "%{repository_slug}#%{build_number} (%{branch}-%{commit}:%{author})-%{message}- %{build_url}"
